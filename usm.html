<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>USM</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <h1>USM-hÃ¤ndelser</h1>
  <nav>
    <a href="index.html">Alla</a>
    <a href="usm.html">USM</a>
    <a href="cup.html">Cuper</a>
    <a href="ledig.html">Ledigt</a>
  </nav>
  <div id="event-container"></div>
  <script>
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQwy0b0RMcUXo3xguOtukMryHNlYnebQdskaIWHXr3POx7fg9NfUHsMTGjOlDnkOJZybrWZ7r36NfB1/pub?output=csv';

    function loadEvents() {
      fetch(SHEET_URL)
        .then(response => response.text())
        .then(csvText => {
          Papa.parse(csvText, {
            header: true,
            skipEmptyLines: true,
            complete: function(results) {
              const events = results.data;
              const todayStr = new Date().toISOString().split("T")[0];
              const container = document.getElementById('event-container');

              const filter = e['Typ av hÃ¤ndelse'].toLowerCase() === 'usm';

              const filtered = events.filter(filter);
              filtered.sort((a, b) => new Date(a['Datum frÃ¥n']) - new Date(b['Datum frÃ¥n']));

              filtered.forEach(e => {
                const card = document.createElement('div');
                card.className = 'event-card';
                card.innerHTML = `
                  <strong>${e['Namn pÃ¥ hÃ¤ndelse']}</strong><br>
                  ğŸ“ ${e['Plats']} | ğŸ· ${e['Typ av hÃ¤ndelse']}<br>
                  ğŸ“… ${e['Datum frÃ¥n']} â€“ ${e['Datum till']}<br>
                  â° ${e['Samling HÃ¤rnÃ¶sand'] || ''} ${e['Samling pÃ¥ plats'] || ''}<br>
                  ğŸ« Ledig frÃ¥n skolan: ${e['Ledig frÃ¥n skolan?']}<br>
                  ğŸ’° Kostnad: ${e['Kostnad per spelare']}<br>
                  ğŸš— FÃ¤rdsÃ¤tt: ${e['FÃ¤rdsÃ¤tt']}<br>
                  ${e["LÃ¤nk till hemsida"] ? `ğŸ”— <a href="${e["LÃ¤nk till hemsida"]]}" target="_blank">Mer info</a>` : ""}
                `;
                container.appendChild(card);
              });
            }
          });
        });
    }

    document.addEventListener("DOMContentLoaded", loadEvents);
  </script>
</body>
</html>
